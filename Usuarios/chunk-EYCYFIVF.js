import{a as Fe,b as Ae,c as Te,d as Me,e as je,f as Q}from"./chunk-M3JQWVXV.js";import{a as Ie,b as Ve}from"./chunk-PZQK3MRC.js";import{a as $}from"./chunk-VGYH6GAK.js";import{g as A,h as J}from"./chunk-6XYQ7BMQ.js";import{a as K}from"./chunk-6QZQREYV.js";import{C as Y,D as Ee,G as De,a as ve,b as he,h as be,m as Se,o as ee,q as _e,t as ye,w as we}from"./chunk-F5EWGMC5.js";import{e as U}from"./chunk-3OIUUP25.js";import{F as ue,G as fe,H as ge,I as xe,L as Z,s as pe}from"./chunk-FIFHZQ6R.js";import{Da as G,Ia as Ce,d as O,e as P,f as q,i as H,k as se,l as F,na as me,oa as de,q as L,qa as ce,x as X,z}from"./chunk-Q3PXOYDA.js";import{$b as h,Db as t,Eb as r,Fb as D,Gb as M,Hb as j,Jb as V,Pb as v,Rb as u,Yb as oe,Zb as i,_a as l,_b as c,ac as ne,bc as B,ca as S,cc as I,fc as re,gc as ae,ha as _,ia as d,kc as g,la as y,lc as k,mc as b,nc as le,q as te,qb as x,sb as p,va as w,wa as E,za as ie,zb as R}from"./chunk-LGQ6X4JS.js";import{a as T}from"./chunk-NEB6MB4Y.js";var W=(()=>{let o=class o{constructor(e,a){this._http=e,this.appSettings=a}getCreditos(e){return this._http.get(`${this.appSettings.creditos.url.base}/${e}`)}getCreditosCard(){return this._http.get(`${this.appSettings.creditos.url.base}/TrabajadorCard`)}getCredito(e){return this._http.get(`${this.appSettings.creditos.url.base}/${e}`)}putCredito(e){let a=e.id;return delete e.id,this._http.put(`${this.appSettings.creditos.url.base}/${a}`,e)}};o.\u0275fac=function(a){return new(a||o)(_(L),_(Z))},o.\u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var ke=(()=>{let o=class o extends ce{parse(e){if(e){let[a,s,f]=e.split("-").map(Number);return new Date(a,s-1,f)}return null}format(e,a){let s=e.getFullYear(),f=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}/${f}/${s}`}};o.\u0275fac=(()=>{let e;return function(s){return(e||(e=ie(o)))(s||o)}})(),o.\u0275prov=S({token:o,factory:o.\u0275fac});let n=o;return n})();var qe=(n,o)=>({"bg-crediblue-50":n,"bg-credigray-100":o});function He(n,o){n&1&&(t(0,"mat-error"),i(1,"El valor es requerido!"),r())}function Le(n,o){n&1&&(t(0,"mat-error"),i(1,"El valor ingresado no puede superar el cupo disponible!"),r())}var ze={validation:!1},$e=(()=>{let o=class o{constructor(){this._matData=d(fe),this.swalService=d(J),this.tipoSolicitudService=d(je),this.aesEncriptService=d(U),this.tipoSolicitud$=this.tipoSolicitudService.getTipos().pipe(te(e=>{let a=e.data.find(s=>s.nombre==="Desembolsos");return a&&(this.idSolicitud=a.id),e})).subscribe(),this.cupo=new ye(""),this.fuseService=d(A),this.solicitudService=d(Ae),this.dialogRef=d(ue)}validarCampo(){this.cupoAvance=this.aesEncriptService.decrypt(this._matData.data.cupoDisponible);let e=Number(this.cupoAvance);this.cupo.setValidators(ee.compose([ee.required,Ge(e)])),this.cupo.updateValueAndValidity()}onSave(){let e={cupo:Number(this.cupo.value),idTipoSolicitud:this.idSolicitud};this.fuseService.open(T({},$)).afterClosed().subscribe(s=>{s==="confirmed"?this.solicitudService.postSolicitudes(e).subscribe(f=>{this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.closeDialog()},f=>{this.swalService.ToastAler({icon:"info",title:f.error.errorMenssages[0],timer:6e3})}):this.closeDialog()})}closeDialog(){this.dialogRef.close()}ngOnInit(){this.validarCampo()}};o.\u0275fac=function(a){return new(a||o)},o.\u0275cmp=y({type:o,selectors:[["app-dialog-confirm-desembolso"]],standalone:!0,features:[B([Te(ze)]),I],decls:25,vars:17,consts:[[1,"relative","flex","h-full","w-full","flex-col"],[1,"flex","flex-auto","flex-col","items-center","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex","h-10","w-10","flex-0","items-center","justify-center","rounded-full","sm:mr-4","bg-blue-100","text-blue-600","dark:bg-blue-600","dark:text-blue-50"],[3,"svgIcon"],[1,"flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:pr-8","sm:text-left"],[1,"text-xl","font-medium","leading-6"],[1,"text-secondary"],[1,"mt-4","flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:text-left"],["floatLabel","always",1,"w-full"],["matInput","","thousandSeparator",".","placeholder","Valor solicitado",3,"formControl","mask"],[4,"ngIf"],[1,"flex","flex-col","sm:flex-row","gap-2","items-center","justify-center","bg-gray-50","py-4","dark:bg-black","dark:bg-opacity-10","sm:justify-end"],["mat-stroked-button","",1,"sm:w-auto","w-full","bg-crediorange-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"matDialogClose"],["mat-flat-button","",1,"sm:w-auto","w-full","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click","color","matDialogClose","ngClass","disabled"]],template:function(a,s){a&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),D(3,"mat-icon",3),r(),t(4,"div",4)(5,"div",5),i(6," Confirmacion "),r(),t(7,"div",6),i(8," Tu cupo disponible es de "),t(9,"b"),i(10),g(11,"currency"),r(),i(12,", puedes solicitar un valor menor o igual a este. "),r()()(),t(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),i(16,"Valor"),r(),D(17,"input",9),x(18,He,2,0,"mat-error",10)(19,Le,2,0,"mat-error",10),r()(),t(20,"div",11)(21,"button",12),i(22," Cancelar "),r(),t(23,"button",13),v("click",function(){return s.onSave()}),i(24," Confirmar "),r()()()),a&2&&(l(3),p("svgIcon","heroicons_solid:question-mark-circle"),l(7),c(b(11,11,s.cupoAvance,"USD")),l(7),p("formControl",s.cupo)("mask","separator.0"),l(),p("ngIf",s.cupo.touched&&s.cupo.hasError("required")),l(),p("ngIf",(s.cupo.touched||s.cupo.dirty)&&s.cupo.hasError("notEqual")),l(2),p("matDialogClose","cancelled"),l(2),p("color","primary")("matDialogClose","confirmed")("ngClass",re(14,qe,s.cupo.valid,s.cupo.invalid))("disabled",s.cupo.invalid))},dependencies:[Y,Se,_e,G,be,Ce,De,ve,xe,Ee,we,q,he,F,Me,O],styles:[".custom-dialog-container{width:100%}@media (min-width: 600px){  .custom-dialog-container{width:40%}}@media (min-width: 1280px){  .custom-dialog-container{width:33.333333%}}"]});let n=o;return n})();function Ge(n){return o=>{let m=o.value;return console.log(n),m>n?{notEqual:!0}:null}}var Ne=(()=>{let o=class o{constructor(e,a){this._http=e,this.appSettings=a}getDetalle(e){return this._http.get(`${this.appSettings.detalleConsumos.url.base}/${e}`)}getConsumo(e){return this._http.get(`${this.appSettings.detalleConsumos.url.base}/${e}`)}getConsumoTrabajador(e){return this._http.get(`${this.appSettings.detalleConsumos.url.baseTrabajador}/${e}`)}postDetalle(e){return this._http.post(this.appSettings.detalleConsumos.url.base,e)}postDesembolso(e){return this._http.post(this.appSettings.detalleConsumos.url.base,e)}getResumen(e){return this._http.get(`${this.appSettings.detalleConsumos.url.base}/trabajador/${e}`)}patchConsumo(e){let a=e.id;delete e.id;let{idEstado:s}=e;return this._http.patch(`${this.appSettings.detalleConsumos.url.base}/${a}?idEstado=${s}`,{})}};o.\u0275fac=function(a){return new(a||o)(_(L),_(Z))},o.\u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var Ze=(n,o,m)=>({"bg-green-600":n,"bg-yellow-600":o,"bg-red-600":m});function Ue(n,o){n&1&&(t(0,"p",16),i(1,"Movimientos"),r())}function Ye(n,o){if(n&1){let m=V();M(0),t(1,"div",25)(2,"button",26),v("click",function(){w(m);let a=u().$implicit,s=u(3);return E(s.onReject(a.id))}),i(3," Rechazar "),r(),t(4,"button",27),v("click",function(){w(m);let a=u().$implicit,s=u(3);return E(s.onSave(a.id))}),i(5," Aprobar "),r()(),j()}}function Je(n,o){if(n&1&&(M(0),t(1,"fuse-card",20)(2,"div",21)(3,"p",10),i(4),r(),t(5,"p",10),i(6),g(7,"date"),r()(),t(8,"div",21)(9,"p",10),i(10,"Factura: "),t(11,"span",11),i(12),r()(),t(13,"p",10),i(14,"Valor: "),t(15,"span",11),i(16),g(17,"currency"),r()()(),t(18,"div",21)(19,"p",10),i(20,"Cuotas: "),t(21,"span",11),i(22),r()(),t(23,"p",10),i(24),r()(),t(25,"div",21)(26,"p",10),i(27,"Tipo: "),t(28,"span",11),i(29),r()()(),t(30,"div",22),D(31,"p",23),r(),x(32,Ye,6,0,"ng-container",24),r(),j()),n&2){let m=o.$implicit,e=u(3);l(4),c(m.nombreSubEmpresa),l(2),c(b(7,9,m.fechaCreacion,"dd/MM/yyyy")),l(6),h(" ",m.numeroFactura," "),l(4),h(" ",k(17,12,e.aesEncriptService.decrypt(m.montoConsumo))," "),l(6),h(" ",m.cantidadCuotas," "),l(2),c(m.nombreEstadoCredito),l(5),h(" ",m.nombreTipoConsumo," "),l(2),p("ngClass",ae(14,Ze,m.idEstadoCredito==e.CodigosDetalleConsumo.APROBADA,m.idEstadoCredito==e.CodigosDetalleConsumo.EN_REVISION,m.idEstadoCredito==e.CodigosDetalleConsumo.RECHAZADA)),l(),p("ngIf",m.idEstadoCredito==e.CodigosDetalleConsumo.EN_REVISION&&m.idTipoConsumo!="e626ea69-e995-4462-be9a-905326114791")}}function Ke(n,o){if(n&1&&(t(0,"div",17)(1,"div",18),x(2,Je,33,18,"ng-container",19),r()()),n&2){let m=u(2);l(2),p("ngForOf",m.items.detalleConsumos)}}function Qe(n,o){n&1&&(t(0,"div",3)(1,"fuse-alert",28)(2,"span",29),i(3,"Informaci\xF3n"),r(),i(4," No tienes movimientos realizados en este momento. "),r()()),n&2&&(l(),p("type","info")("appearance","outline"))}function We(n,o){if(n&1){let m=V();t(0,"div",1)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h2",6),i(5,"Detalle de Cr\xE9dito"),r()(),t(6,"div",7)(7,"div",8)(8,"div")(9,"h3",9),i(10),r(),t(11,"p",10),i(12,"Identificaci\xF3n: "),t(13,"span",11),i(14),r()(),t(15,"p",10),i(16,"Empresa: "),t(17,"span",11),i(18),r()(),t(19,"p",10),i(20,"Cargo: "),t(21,"span",11),i(22),r()(),t(23,"p",10),i(24,"Correo: "),t(25,"span",11),i(26),r()(),t(27,"p",10),i(28,"Direcci\xF3n: "),t(29,"span",11),i(30),r()(),t(31,"p",10),i(32,"Tel\xE9fono: "),t(33,"span",11),i(34),r()()(),t(35,"div")(36,"p",10),i(37,"N\xFAmero de cr\xE9dito: "),t(38,"span",11),i(39),r()(),t(40,"p",10),i(41,"Cupo aprobado: "),t(42,"span",11),i(43),g(44,"currency"),r()(),t(45,"p",10),i(46,"Tasa de interes d\xEDaria: "),t(47,"span",11),i(48),r()(),t(49,"p",10),i(50,"Fecha de aprobacion: "),t(51,"span",11),i(52),g(53,"date"),r()(),t(54,"p",10),i(55,"Fecha de vencimiento: "),t(56,"span",11),i(57),g(58,"date"),r()(),t(59,"p",10),i(60,"Fecha de corte: "),t(61,"span",11),i(62),g(63,"date"),r()(),t(64,"p",10),i(65,"Cupo utilizado: "),t(66,"span",11),i(67),g(68,"currency"),r()(),t(69,"p",10),i(70,"Saldo Disponible: "),t(71,"span",11),i(72),g(73,"currency"),r()(),t(74,"button",12),v("click",function(){w(m);let a=u();return E(a.onSolicitud())}),i(75," Solicitar avance "),r()()(),D(76,"hr",13),x(77,Ue,2,0,"p",14)(78,Ke,3,1,"div",15)(79,Qe,5,2,"ng-template",null,0,le),r()()()()}if(n&2){let m=oe(80),e=u();l(10),ne("",e.items.trabajador.primerNombre," ",e.items.trabajador.segundoNombre," ",e.items.trabajador.primerApellido," ",e.items.trabajador.segundoApellido," "),l(4),c(e.items.trabajador.numDoc),l(4),c(e.items.nombreSubEmpresa),l(4),c(e.items.trabajador.cargo),l(4),c(e.items.trabajador.correo),l(4),c(e.items.trabajador.direccion),l(4),c(e.items.trabajador.telefono),l(5),c(e.items.numCredito),l(4),c(k(44,21,e.aesEncriptService.decrypt(e.items.cupoAprobado))),l(5),h("",e.aesEncriptService.decrypt(e.items.porcTasaInteres),"%"),l(4),c(b(53,23,e.items.fechaAprobacion,"dd/MM/yyyy")),l(5),c(b(58,26,e.items.fechaVencimiento,"dd/MM/yyyy")),l(5),c(b(63,29,e.items.fechaCorte,"dd/MM/yyyy")),l(5),c(k(68,32,e.aesEncriptService.decrypt(e.items.cupoConsumido))),l(5),c(k(73,34,e.aesEncriptService.decrypt(e.items.cupoDisponible))),l(5),p("ngIf",e.items.detalleConsumos),l(),p("ngIf",e.items.detalleConsumos.length)("ngIfElse",m)}}function Xe(n,o){n&1&&(t(0,"div",2)(1,"div",3)(2,"fuse-alert",28)(3,"span",29),i(4,"Informaci\xF3n"),r(),i(5," No cuentas con cr\xE9ditos activos. "),r()()()),n&2&&(l(2),p("type","info")("appearance","outline"))}var Re=(()=>{let o=class o{constructor(){this.toasService=d(Fe),this.fuseService=d(A),this.estadosDatosService=d(Ie),this.activatedRoute=d(X),this.creditoService=d(W),this.detalleConsumoService=d(Ne),this.router=d(z),this.route=d(X),this.datePipe=d(H),this.data=[],this.capital=[],this.estadoCredito=[],this.tasas=[],this.idCredito="",this._matDialog=d(ge),this.swalService=d(J),this.aesEncriptService=d(U),this.currencyPipe=d(F),this.CodigosDetalleConsumo=Q}ngOnDestroy(){this.subcription$.unsubscribe()}onSolicitud(){this._matDialog.open($e,{data:{data:this.items},disableClose:!0,panelClass:"custom-dialog-container"})}onSave(e){let a={idEstado:Q.APROBADA,id:e};this.fuseService.open(T({},$)).afterClosed().subscribe(f=>{f==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(C=>{C.isExitoso&&(this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.getCredito(this.idCredito))},C=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}))})}onReject(e){let a={idEstado:Q.RECHAZADA,id:e};this.fuseService.open(T({},$)).afterClosed().subscribe(f=>{f==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(C=>{C.isExitoso&&(this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.getCredito(this.idCredito))},C=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}))})}ngOnInit(){this.idCredito="Trabajador";let e=this.activatedRoute.snapshot.paramMap.get("id");this.getCredito(e)}getCredito(e){this.subcription$=this.creditoService.getCredito(e).pipe().subscribe(a=>{this.items=a.data})}};o.\u0275fac=function(a){return new(a||o)},o.\u0275cmp=y({type:o,selectors:[["app-form-view-detalle"]],standalone:!0,features:[B([{provide:de,useClass:ke},{provide:me,useValue:"en-GB"},H,F,se]),I],decls:2,vars:1,consts:[["noTiene",""],["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-8","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","mx-auto","overflow-hidden","w-full","max-w-5xl"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],[1,"text-lg","sm:text-xl","font-bold","text-white"],[1,"p-4","sm:p-6"],[1,"mb-4","grid","grid-cols-1","md:grid-cols-2","gap-4","justify-items-stretch","lg:justify-items-center"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-800"],[1,"font-medium","text-gray-600"],[1,"text-md","text-secondary"],["mat-flat-button","",1,"lg:w-auto","w-full","mt-4","bg-green-600","transition","duration-200","text-white","font-semibold","rounded-lg","md:w-auto",3,"click"],[1,"my-4"],["class","lg:text-center text-lg font-semibold font-bold mb-6",4,"ngIf"],["class","mb-4",4,"ngIf","ngIfElse"],[1,"lg:text-center","text-lg","font-semibold","font-bold","mb-6"],[1,"mb-4"],[1,"flex","flex-wrap","gap-2.5","justify-center"],[4,"ngFor","ngForOf"],[1,"flex","flex-col","p-6","rounded-2xl","shadow-2xl","w-full","md:w-1/2","lg:w-96"],[1,"flex","justify-between"],[1,"w-full","mt-2"],[1,"h-2.5","rounded-full",3,"ngClass"],[4,"ngIf"],[1,"flex","justify-between","items-center","mt-2","p-4","gap-2.5"],["mat-flat-button","",1,"lg:w-auto","w-full","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"lg:w-auto","w-full","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(a,s){a&1&&x(0,We,81,36,"div",1)(1,Xe,6,2,"div",2),a&2&&R(s.items?0:1)},dependencies:[pe,F,H,Y,G,P,q,Ve,O,K]});let n=o;return n})();function et(n,o){if(n&1){let m=V();M(0),t(1,"div",7)(2,"div",8)(3,"h2",9),i(4),r(),t(5,"p",10),i(6,"Estado: "),t(7,"span",11),i(8),r()(),t(9,"p",10),i(10,"Cuotas: "),t(11,"span",12),i(12),r()(),t(13,"p",10),i(14,"Vencimiento: "),t(15,"span",12),i(16),r()(),t(17,"div",13)(18,"button",14),v("click",function(){let a=w(m).$implicit,s=u(2);return E(s.onSelect(a.id))}),i(19," Ver Detalles "),r()()()(),j()}if(n&2){let m=o.$implicit;l(4),h("Cr\xE9dito #",m.numCredito,""),l(4),c(m.nombreEstadoCredito),l(4),c(m.cantCuotas),l(4),c(m.fechaVencimiento)}}function tt(n,o){if(n&1&&(t(0,"div",3)(1,"div",5),x(2,et,20,4,"ng-container",6),r()()),n&2){let m=u();l(2),p("ngForOf",m.data)}}function it(n,o){n&1&&(t(0,"div",4)(1,"div",15)(2,"fuse-alert",16)(3,"span",17),i(4,"Informaci\xF3n"),r(),i(5," No has realizado ninguna solicitud hasta el momento. "),r()()()),n&2&&(l(2),p("type","info")("appearance","outline"))}var Be=(()=>{let o=class o{constructor(){this.creditoService=d(W),this.fuseService=d(A),this.router=d(z),this.data=[]}getCredito(){this.subcription$=this.creditoService.getCreditosCard().subscribe(e=>{if(e.data.length===1){let a=e.data[0].id;this.router.navigate(["/pages/gestion-creditos/creditos/view-detalle",a])}else this.data=e.data})}ngOnInit(){this.getCredito()}onSelect(e){this.router.navigate(["/pages/gestion-creditos/creditos/view-detalle",e])}};o.\u0275fac=function(a){return new(a||o)},o.\u0275cmp=y({type:o,selectors:[["app-mis-creditos"]],standalone:!0,features:[I],decls:6,vars:1,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"flex","flex-auto","overflow-hidden","bg-gray-100"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"flex","flex-auto","flex-col","sm:flex-row","sm:flex-wrap","gap-2.5","justify-center","overflow-hidden","sm:overflow-y-auto","bg-gray-100","sm:p-2"],[4,"ngFor","ngForOf"],[1,"max-w-sm","w-full","mx-auto","p-4"],[1,"bg-white","shadow-lg","rounded-2xl","p-6","border","border-gray-200"],[1,"text-xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600","text-sm"],[1,"font-semibold","text-green-600"],[1,"font-semibold"],[1,"mt-4"],[1,"w-full","bg-blue-600","text-white","py-2","px-4","rounded-lg","hover:bg-blue-700","transition",3,"click"],[1,"inline-block","p-4","sm:p-8","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(a,s){a&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),i(3,"M\xEDs cr\xE9ditos"),r()(),x(4,tt,3,1,"div",3)(5,it,6,2,"div",4),r()),a&2&&(l(4),R(s.data.length?4:5))},dependencies:[K,P]});let n=o;return n})();var di=[{path:"",component:Be},{path:"view-detalle/:id",component:Re}];export{di as default};
