import{a as Ee}from"./chunk-D3FYSJU5.js";import{a as we}from"./chunk-LKAMKEVR.js";import{a as D}from"./chunk-FAEUQIFQ.js";import{a as De,b as x}from"./chunk-P4PAYY2C.js";import{a as Se}from"./chunk-WMNOZPY7.js";import{a as ve,b as Te,c as _e}from"./chunk-73HPXQ4R.js";import{a as xe}from"./chunk-LUBH4OK2.js";import{a as M}from"./chunk-6IEWE3OU.js";import{a as ye}from"./chunk-H2GGAK7L.js";import{a as ge}from"./chunk-QF5DML3C.js";import"./chunk-Q5IBO7O7.js";import{g as ie,h as he}from"./chunk-2MNMAZZP.js";import"./chunk-CY7MRQJZ.js";import"./chunk-P63XEOLN.js";import{C as fe,F as ue,J as be,b as ee,e as oe,i as te,l as ne,n as _,p as le,q as me,s as se,u as ce,x as pe,y as de}from"./chunk-5EZKXU2X.js";import{h as Z}from"./chunk-GQMDELPL.js";import{a as Ce}from"./chunk-VQY6X2PJ.js";import"./chunk-QTY5OGKD.js";import{Q,R as W,ba as Y,ga as ae,la as re}from"./chunk-TS7YPRLN.js";import"./chunk-YMFBC3ZU.js";import"./chunk-5TY7V3W7.js";import"./chunk-ZVLDBLLW.js";import{Ac as H,Cb as T,Dc as J,Eb as L,Ec as F,Gc as K,Hc as j,Lb as E,Mb as f,Nb as X,Qa as a,Vb as B,Wb as O,Zb as G,_ as I,cc as z,dc as $,gb as y,ha as u,ib as n,ma as P,pb as N,q as w,tb as s,ub as l,vb as v,wa as C,wb as R,xa as g,xb as V,yc as q,zb as A,zc as U}from"./chunk-IEDNLM77.js";import{a as S,d as k}from"./chunk-NEB6MB4Y.js";var Me=(o,m)=>({"bg-green-700":o,"bg-credigray-100":m});function ke(o,m){if(o&1&&(s(0,"mat-option",21),f(1),l()),o&2){let d=m.$implicit;n("value",d.id),a(),X(d.nombre)}}function Ie(o,m){if(o&1&&(R(0),y(1,ke,2,2,"mat-option",20),V()),o&2){let d=m.ngIf;a(),n("ngForOf",d.data)}}function Pe(o,m){if(o&1&&(s(0,"div",19)(1,"div",22),v(2,"app-custom-table",23),l()()),o&2){let d=L();a(2),n("columns",d.columns)("displayedColumns",d.columns)("columnPropertyMap",d.columnPropertyMap)("data",d.data)("searchTerm",d.searchTerm)}}function Ne(o,m){o&1&&(s(0,"div",24)(1,"div",25)(2,"fuse-alert",26)(3,"span",27),f(4,"Informaci\xF3n"),l(),f(5," No hay informaci\xF3n hasta el momento. "),l()()()),o&2&&(a(2),n("type","info")("appearance","outline"))}function Re(o,m){o&1&&y(0,Ne,6,2,"ng-template")}var Fe=(()=>{let m=class m{constructor(){this.searchTerm="",this.fb=u(fe),this.reportesService=u(Ee),this.datePipe=u(F),this.estados=new se([""]),this.detalleConsumoService=u(we),this.aesEncriptService=u(Se),this.currencyPipe=u(j),this.fuseService=u(ie),this.detalleConsumo$=this.detalleConsumoService.getDetalleConsumo().pipe(w(r=>(r.data=r.data.filter(t=>t.nombre!=="Rechazado"&&t.nombre!=="Pagado"&&t.nombre!=="En Revision"&&t.nombre!=="En Mora"),r)),I(r=>{let t=r.data;t&&this.form.get("idEstadoCredito").setValue(t[0].id)})),this.data=[],this.exportData=[],this.columns=["Fecha de solicitud","Identificaci\xF3n","Trabajador","Empresa","Cargo","Tipo de contrato","Fecha de inicio contrato","Fecha fin de contrato","Salario devengado","Monto aprobado","Cupo disponible","Tipo de consumo","Tipo de cuenta","Banco","N\xFAmero de cuenta","Estado"],this.columnPropertyMap={"Fecha de solicitud":"fechaCreacion",Identificaci\u00F3n:"documentoTrabajador",Trabajador:"nombreTrabajador",Empresa:"nombreEmpresaTrabajador",Cargo:"cargoTrabajador","Tipo de contrato":"tipoContratoTrabajador","Fecha de inicio contrato":"fechaInicioContratoTrabajador","Fecha fin de contrato":"fechaFinContratoTrabajador","Salario devengado":"salarioDevengadoTrabajador","Monto aprobado":"montoConsumo","Cupo disponible":"cupoDisponibleTrabajador","Tipo de consumo":"tipoConsumo","Tipo de cuenta":"tipoCuentaTrabajador",Banco:"bancotrabajador","N\xFAmero de cuenta":"numeroCuentaTrabajador",Estado:"nombreEstadoCredito"}}convertDataExport(r){let t=r.map(e=>({FechaSolicitud:e.fechaCreacion,Identificacion:e.documentoTrabajador,Trabajador:e.nombreTrabajador,Empresa:e.nombreEmpresaTrabajador,Cargo:e.cargoTrabajador,TipoContrato:e.tipoContratoTrabajador,FechaInicioContrato:e.fechaInicioContratoTrabajador,FechaFinContrato:e.fechaFinContratoTrabajador,SalarioDevengado:D(e.salarioDevengadoTrabajador),MontoAprobado:D(e.montoConsumo),CupoDisponible:D(e.cupoDisponibleTrabajador),TipoConsumo:e.tipoConsumo,TipoCuenta:e.tipoCuentaTrabajador,Banco:e.bancotrabajador,NumeroCuenta:e.numeroCuentaTrabajador,Estado:e.nombreEstadoCredito}));this.exportData=t}onSearch(r){let t=r.target;this.searchTerm=t.value.trim().toLowerCase()}onSelect(r){this.data=[],this.exportData=[]}createForm(){this.form=this.fb.group({idEstadoCredito:["",_.required],fechaInicio:["",_.required],fechaFinal:["",_.required]})}ngOnInit(){this.createForm()}onConsultar(){if(this.form.valid){let r=this.form.getRawValue(),{fechaInicio:t,fechaFinal:e}=r,c=k(r,["fechaInicio","fechaFinal"]),p=this.datePipe.transform(t,"yyyy-MM-dd"),h=this.datePipe.transform(e,"yyyy-MM-dd"),je=S({fechaInicio:p,fechaFinal:h},c);this.reportesService.getReporteDesembolsos(je).pipe(w(b=>(b.data.forEach(i=>{i.estado=i.estado?M.ACTIVO:M.INACTIVO,i.fechaCreacion=this.datePipe.transform(i.fechaCreacion,"dd/MM/yyyy"),i.fechaInicioContratoTrabajador=this.datePipe.transform(i.fechaInicioContratoTrabajador,"dd/MM/yyyy"),i.fechaFinContratoTrabajador=this.datePipe.transform(i.fechaFinContratoTrabajador,"dd/MM/yyyy"),i.salarioDevengadoTrabajador=this.currencyPipe.transform(i.salarioDevengadoTrabajador,"USD","symbol","1.2-2"),i.montoConsumo&&(i.montoConsumo=this.aesEncriptService.decrypt(i.montoConsumo)),i.cupoDisponibleTrabajador=this.currencyPipe.transform(i.cupoDisponibleTrabajador,"USD","symbol","1.2-2"),i.montoConsumo=this.currencyPipe.transform(i.montoConsumo,"USD","symbol","1.2-2")}),b))).subscribe(b=>{b.data?(this.data=b.data,this.convertDataExport(b.data)):this.data=[]})}}exportToExcel(r){this.fuseService.open(S({},he)).afterClosed().subscribe(e=>{if(e==="confirmed"){let c=x.json_to_sheet(r),p=x.book_new();x.book_append_sheet(p,c,"Sheet1"),De(p,`Reporte de Desembolsos${this.datePipe.transform(new Date,"dd/MM/yyyy")}.xlsx`)}})}};m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=P({type:m,selectors:[["app-reporte-desembolsos"]],standalone:!0,features:[B([{provide:W,useClass:xe},{provide:Q,useValue:"en-GB"},F,j,K]),O],decls:38,vars:23,consts:[["inicioPicker",""],["finalPicker",""],["cdkScrollable","",1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],[1,"px-6","border-b","mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"flex","flex-col","sm:flex-row","gap-2.5",3,"formGroup"],[1,"w-full","sm:w-1/2"],[3,"selectionChange","formControlName"],[4,"ngIf"],["floatLabel","always",1,"w-full","sm:w-1/2"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["mat-flat-button","",1,"sm:w-1/6","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:sm:w-1/6","w-full","sm:mt-6","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","searchTerm"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-2","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(t,e){if(t&1){let c=A();s(0,"div",2)(1,"div",3)(2,"div",4),f(3,"Reporte de Desembolsos"),l(),s(4,"div",5)(5,"mat-form-field",6),v(6,"mat-icon",7),s(7,"input",8),T("input",function(h){return C(c),g(e.onSearch(h))}),l()()()(),s(8,"div",9)(9,"form",10)(10,"mat-form-field",11)(11,"mat-label"),f(12,"Estados"),l(),s(13,"mat-select",12),T("selectionChange",function(h){return C(c),g(e.onSelect(h))}),y(14,Ie,2,1,"ng-container",13),z(15,"async"),l()(),s(16,"mat-form-field",14)(17,"mat-label"),f(18,"Fecha de inicio"),l(),v(19,"input",15)(20,"mat-datepicker-toggle",16)(21,"mat-datepicker",null,0),l(),s(23,"mat-form-field",14)(24,"mat-label"),f(25,"Fecha fin"),l(),v(26,"input",15)(27,"mat-datepicker-toggle",16)(28,"mat-datepicker",null,1),l(),s(30,"button",17),T("click",function(){return C(c),g(e.onConsultar())}),s(31,"span"),f(32," Consultar "),l()(),s(33,"button",18),T("click",function(){return C(c),g(e.exportToExcel(e.exportData))}),s(34,"span"),f(35," Exportar "),l()()()(),y(36,Pe,3,5,"div",19)(37,Re,1,0),l()}if(t&2){let c=E(22),p=E(29);a(5),n("subscriptSizing","dynamic"),a(),n("svgIcon","heroicons_solid:magnifying-glass"),a(),n("autocomplete","off")("placeholder","Buscar"),a(2),n("formGroup",e.form),a(4),n("formControlName","idEstadoCredito"),a(),n("ngIf",$(15,18,e.detalleConsumo$)),a(5),n("matDatepicker",c)("formControlName","fechaInicio"),a(),n("for",c),a(6),n("matDatepicker",p)("formControlName","fechaFinal"),a(),n("for",p),a(3),n("color","primary"),a(3),n("color","primary")("ngClass",G(20,Me,e.exportData.length,!e.exportData.length))("disabled",!e.exportData.length),a(3),N(e.data.length>0?36:37)}},dependencies:[J,Z,ye,Ce,ae,ve,Te,_e,te,re,be,ee,Y,ge,oe,U,H,ue,ce,ne,le,me,pe,de,q]});let o=m;return o})();var po=[{path:"",component:Fe}];export{po as default};
