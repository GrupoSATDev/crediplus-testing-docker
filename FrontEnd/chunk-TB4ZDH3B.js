import{a as De}from"./chunk-3MX4MELF.js";import{a as we}from"./chunk-HRYQ2MDO.js";import{a as k}from"./chunk-FAEUQIFQ.js";import{a as Fe,b as T}from"./chunk-P4PAYY2C.js";import{a as Ce,b as xe,c as Te}from"./chunk-LZ3ZEVTF.js";import{a as _e}from"./chunk-DTORAJAR.js";import{a as ge}from"./chunk-3R6HD5RM.js";import{a as ye}from"./chunk-CJO6YW5P.js";import"./chunk-7YBFULQ5.js";import{g as ae,h as be}from"./chunk-QVE5MGEQ.js";import{C as fe,F as he,J as Se,b as ee,e as te,i as oe,l as le,n as x,p as ce,q as me,s as se,u as de,x as pe,y as ue}from"./chunk-4PVPKBBG.js";import{e as ne}from"./chunk-KAEQCOKJ.js";import"./chunk-YKJB7XET.js";import{h as Z}from"./chunk-FUOI65R5.js";import{a as ve}from"./chunk-73F67TFK.js";import"./chunk-XTYNXB3F.js";import"./chunk-2YYUDHRL.js";import{$a as C,Ad as W,Eb as w,Fb as u,Gb as X,Ka as t,Md as Y,Ob as O,Pb as B,Sb as G,Xb as $,Yb as q,Z as j,bb as i,fe as ie,ga as f,ib as N,ka as P,ke as re,mb as n,nb as a,ob as y,pb as V,pc as z,q as I,qb as R,qc as U,rc as H,sb as A,ua as b,uc as J,va as v,vb as g,vc as F,xb as L,xc as K,yc as D,zd as Q}from"./chunk-ODJKW74N.js";import{a as _,d as M}from"./chunk-NEB6MB4Y.js";var Ee=(o,l)=>({"bg-green-700":o,"bg-credigray-100":l});function Me(o,l){if(o&1&&(n(0,"mat-option",22),u(1),a()),o&2){let d=l.$implicit;i("value",d.id),t(),X(d.nombre)}}function Ie(o,l){if(o&1&&(V(0),C(1,Me,2,2,"mat-option",21),R()),o&2){let d=l.ngIf;t(),i("ngForOf",d.data)}}function je(o,l){if(o&1&&(n(0,"div",19)(1,"div",23),y(2,"app-custom-table",24),a()()),o&2){let d=L();t(2),i("columns",d.columns)("displayedColumns",d.columns)("columnPropertyMap",d.columnPropertyMap)("data",d.data)("searchTerm",d.searchTerm)}}function Pe(o,l){o&1&&(n(0,"div",20)(1,"div",25)(2,"fuse-alert",26)(3,"span",27),u(4,"Informaci\xF3n"),a(),u(5," No hay informaci\xF3n hasta el momento. "),a()()()),o&2&&(t(2),i("type","info")("appearance","outline"))}var ke=(()=>{let l=class l{constructor(){this.searchTerm="",this.fb=f(fe),this.reportesService=f(De),this.datePipe=f(F),this.estados=new se([""]),this.data=[],this.aesEncriptService=f(ne),this.tipoSolicitudesService=f(we),this.currencyPipe=f(D),this.exportData=[],this.fuseService=f(ae),this.columns=["N\xFAmero de solicitud","Fecha de solicitud","Cupo","Trabajador","Identificaci\xF3n","Salario devengado","Inicio de contrato","Fin de contrato","Empresa","Tipo de solicitud"],this.columnPropertyMap={"N\xFAmero de solicitud":"numSolicitud","Fecha de solicitud":"fechaCreacion",Cupo:"cupo",Trabajador:"nombreTrabajador",Identificaci\u00F3n:"documetoTrabajador","Salario devengado":"salarioDevengadoTrabajador","Inicio de contrato":"fechaInicioContratoTrabajador","Fin de contrato":"fechaFinContratoTrabajador",Empresa:"nombreSubEmpresa","Tipo de solicitud":"nombreTipoSolicitud"},this.solicitudes$=this.tipoSolicitudesService.getTipos().pipe(j(c=>{let r=c.data;r&&(r.unshift({id:"null",nombre:"Todos"}),this.form.get("idTipoSolicitud").setValue(r[0].id))}))}onSearch(c){let r=c.target;this.searchTerm=r.value.trim().toLowerCase()}onSelect(c){let r=c.value}ngOnInit(){this.createForm()}onConsultar(){if(this.form.valid){let c=this.form.getRawValue(),{fechaInicio:r,fechaFinal:e}=c,m=M(c,["fechaInicio","fechaFinal"]),s=this.datePipe.transform(r,"yyyy-MM-dd"),S=this.datePipe.transform(e,"yyyy-MM-dd"),E=_({fechaInicio:s,fechaFinal:S},m);console.log(E),this.reportesService.getReporteSolicitudes(E).pipe(I(h=>(h.data.forEach(p=>{p.fechaCreacion=this.datePipe.transform(p.fechaCreacion,"dd/MM/yyyy"),p.fechaInicioContratoTrabajador=this.datePipe.transform(p.fechaInicioContratoTrabajador,"dd/MM/yyyy"),p.fechaFinContratoTrabajador=this.datePipe.transform(p.fechaFinContratoTrabajador,"dd/MM/yyyy"),p.cupo=this.currencyPipe.transform(p.cupo,"USD","symbol","1.2-2"),p.salarioDevengadoTrabajador=this.currencyPipe.transform(p.salarioDevengadoTrabajador,"USD","symbol","1.2-2")}),h))).subscribe(h=>{h.data?(this.data=h.data,this.convertDataExportFijos(h.data)):this.data=[]})}}convertDataExportFijos(c){let r=c.map(e=>({NumeroSolicitud:e.numSolicitud,FechaSolicitud:e.fechaCreacion,Cupo:k(e.cupo),Trabajador:e.nombreTrabajador,Identificaci\u00F3n:e.documetoTrabajador,Salariodevengado:k(e.salarioDevengadoTrabajador),Iniciodecontrato:e.fechaInicioContratoTrabajador,Findecontrato:e.fechaFinContratoTrabajador,Empresa:e.nombreSubEmpresa,TipodeSolicitud:e.nombreTipoSolicitud}));this.exportData=r}exportToExcel(c){this.fuseService.open(_({},be)).afterClosed().subscribe(e=>{if(e==="confirmed"){let m=T.json_to_sheet(c),s=T.book_new();T.book_append_sheet(s,m,"Sheet1"),Fe(s,`Reporte de solicitudes${this.datePipe.transform(new Date,"dd/MM/yyyy")}.xlsx`)}})}createForm(){this.form=this.fb.group({idTipoSolicitud:["",x.required],fechaInicio:["",x.required],fechaFinal:["",x.required]})}};l.\u0275fac=function(r){return new(r||l)},l.\u0275cmp=P({type:l,selectors:[["app-reporte-solicitudes"]],standalone:!0,features:[O([{provide:W,useClass:_e},{provide:Q,useValue:"en-GB"},F,D,K]),B],decls:38,vars:23,consts:[["inicioPicker",""],["finalPicker",""],["cdkScrollable","",1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],[1,"px-6","border-b","mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"flex","flex-col","sm:flex-row","gap-2.5",3,"formGroup"],[1,"w-full","sm:w-1/2"],[3,"selectionChange","formControlName"],[4,"ngIf"],["floatLabel","always",1,"w-full","sm:w-1/2"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["mat-flat-button","",1,"sm:w-1/6","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:sm:w-1/6","w-full","sm:mt-6","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","searchTerm"],[1,"inline-block","p-4","sm:p-2","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(r,e){if(r&1){let m=A();n(0,"div",2)(1,"div",3)(2,"div",4),u(3,"Reporte de Solicitudes"),a(),n(4,"div",5)(5,"mat-form-field",6),y(6,"mat-icon",7),n(7,"input",8),g("input",function(S){return b(m),v(e.onSearch(S))}),a()()()(),n(8,"div",9)(9,"form",10)(10,"mat-form-field",11)(11,"mat-label"),u(12,"Estados"),a(),n(13,"mat-select",12),g("selectionChange",function(S){return b(m),v(e.onSelect(S))}),C(14,Ie,2,1,"ng-container",13),$(15,"async"),a()(),n(16,"mat-form-field",14)(17,"mat-label"),u(18,"Fecha de inicio"),a(),y(19,"input",15)(20,"mat-datepicker-toggle",16)(21,"mat-datepicker",null,0),a(),n(23,"mat-form-field",14)(24,"mat-label"),u(25,"Fecha fin"),a(),y(26,"input",15)(27,"mat-datepicker-toggle",16)(28,"mat-datepicker",null,1),a(),n(30,"button",17),g("click",function(){return b(m),v(e.onConsultar())}),n(31,"span"),u(32," Consultar "),a()(),n(33,"button",18),g("click",function(){return b(m),v(e.exportToExcel(e.exportData))}),n(34,"span"),u(35," Exportar "),a()()()(),C(36,je,3,5,"div",19)(37,Pe,6,2,"div",20),a()}if(r&2){let m=w(22),s=w(29);t(5),i("subscriptSizing","dynamic"),t(),i("svgIcon","heroicons_solid:magnifying-glass"),t(),i("autocomplete","off")("placeholder","Buscar"),t(2),i("formGroup",e.form),t(4),i("formControlName","idTipoSolicitud"),t(),i("ngIf",q(15,18,e.solicitudes$)),t(5),i("matDatepicker",m)("formControlName","fechaInicio"),t(),i("for",m),t(6),i("matDatepicker",s)("formControlName","fechaFinal"),t(),i("for",s),t(3),i("color","primary"),t(3),i("color","primary")("ngClass",G(20,Ee,e.exportData.length,!e.exportData.length))("disabled",!e.exportData.length),t(3),N(e.data.length>0?36:37)}},dependencies:[J,Z,ge,ve,ie,Ce,xe,Te,oe,re,Se,ee,Y,ye,te,U,H,he,de,le,ce,me,pe,ue,z]});let o=l;return o})();var ct=[{path:"",component:ke}];export{ct as default};
