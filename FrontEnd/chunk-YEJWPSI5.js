import{a as M}from"./chunk-2U76ZNDX.js";import{a as W}from"./chunk-X5KNPYGK.js";import{a as Q}from"./chunk-K7UKSVEC.js";import{a as b}from"./chunk-6IEWE3OU.js";import{a as E}from"./chunk-L5Y3WK7D.js";import{a as K}from"./chunk-BW2UNIQM.js";import"./chunk-CEE3O4CX.js";import{c as z}from"./chunk-C7ANG7GI.js";import"./chunk-566EJEQN.js";import{C as q,F as J,J as x,b as B,i as S,p as U,s as L,w as H}from"./chunk-NFNLINIV.js";import{b as A,d as y}from"./chunk-V24ZDQ6I.js";import"./chunk-32OSWJVT.js";import{ba as R,la as P}from"./chunk-IP22JCCO.js";import"./chunk-VFBDOJ4Z.js";import"./chunk-J6S3X3IJ.js";import{Ac as $,Cb as D,Dc as k,Ec as f,Hc as u,Mb as c,Nb as j,Qa as i,Ra as _,Vb as g,Wb as C,_ as I,cc as N,dc as V,gb as w,ha as a,ib as n,ma as v,q as d,tb as m,ub as l,vb as p,wb as F,xb as O,zc as G}from"./chunk-VNCXNJPE.js";import"./chunk-NEB6MB4Y.js";function oe(s,r){if(s&1&&(m(0,"mat-option",14),c(1),l()),s&2){let h=r.$implicit;n("value",h.id),i(),j(h.nombre)}}function te(s,r){if(s&1&&(F(0),w(1,oe,2,2,"mat-option",13),O()),s&2){let h=r.ngIf;i(),n("ngForOf",h.data)}}var X=(()=>{let r=class r{constructor(t){this._matDialog=t,this.datePipe=a(f),this.router=a(y),this.estadoDatosService=a(Q),this.currencyPipe=a(u),this.cobroTrabadorService=a(M),this.estadoCreditosService=a(W),this.fb=a(q),this.estados=new L([""]),this.searchTerm="",this.estadoCreditos$=this.estadoCreditosService.getEstadoCobros().pipe(I(e=>{let o=e.data;o&&(this.estados.setValue(o[1].id),this.cobros(o[1].id))})),this.data=[],this.columns=["Nombre completo","Valor proximo a pagar","Deuda total","Empresa","Estado"],this.columnPropertyMap={"Nombre completo":"nombreTrabajador","Valor proximo a pagar":"montoProximoPago","Deuda total":"deudaTotal",Empresa:"nombreSubEmpresa",Estado:"nombreEstadoCredito"},this.buttons=[{label:"View",icon:"visibility",action:e=>{console.log("Editing",e),this.selectedData=e,this.router.navigate(["pages/gestion-cobros/cobros/cobro",this.selectedData.idTrabajador])}}]}onSelect(t){let e=t.value;this.cobros(e)}cobros(t){this.subcription$=this.cobroTrabadorService.getCobrosGrid(t).pipe(d(e=>(e.data.forEach(o=>{o.estado?o.estado=b.ACTIVO:o.estado=b.INACTIVO}),e)),d(e=>(e.data.forEach(o=>{o.deudaTotal=this.currencyPipe.transform(o.deudaTotal,"USD","symbol","1.2-2"),o.montoProximoPago=this.currencyPipe.transform(o.montoProximoPago,"USD","symbol","1.2-2")}),e))).subscribe(e=>{e?this.data=e.data:this.data=[]},e=>{this.data=[]})}getCobros(){this.subcription$=this.cobroTrabadorService.getCobros().pipe(d(t=>(t.data.forEach(e=>{e.estado?e.estado=b.ACTIVO:e.estado=b.INACTIVO}),t)),d(t=>(t.data.forEach(e=>{e.fechaCobro=this.datePipe.transform(e.fechaCobro,"dd/MM/yyyy"),e.valorPendiente=this.currencyPipe.transform(e.valorPendiente,"USD","symbol","1.2-2"),e.valorPago=e.valorPago?this.currencyPipe.transform(e.valorPago,"USD","symbol","1.2-2"):"-"}),t))).subscribe(t=>{t?this.data=t.data:this.data=[]},t=>{this.data=[]})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(e=>{})}onSearch(t){let e=t.target;this.searchTerm=e.value.trim().toLowerCase()}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.listenGrid()}};r.\u0275fac=function(e){return new(e||r)(_(z))},r.\u0275cmp=v({type:r,selectors:[["app-grid-cobros-empleados"]],standalone:!0,features:[g([f,u]),C],decls:17,vars:14,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","gap-2.5","sm:ml-4","sm:mt-0","sm:flex-row","sm:w-1/2"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-1/2",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],[1,"w-full","sm:w-1/2"],[3,"selectionChange","formControl"],[4,"ngIf"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons","searchTerm"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,o){e&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),c(3,"Historico de Cartera - Trabajadores"),l(),m(4,"div",3)(5,"mat-form-field",4),p(6,"mat-icon",5),m(7,"input",6),D("input",function(T){return o.onSearch(T)}),l()(),m(8,"mat-form-field",7)(9,"mat-label"),c(10,"Estados"),l(),m(11,"mat-select",8),D("selectionChange",function(T){return o.onSelect(T)}),w(12,te,2,1,"ng-container",9),N(13,"async"),l()()()(),m(14,"div",10)(15,"div",11),p(16,"app-custom-table",12),l()()()),e&2&&(i(5),n("subscriptSizing","dynamic"),i(),n("svgIcon","heroicons_solid:magnifying-glass"),i(),n("autocomplete","off")("placeholder","Buscar"),i(4),n("formControl",o.estados),i(),n("ngIf",V(13,12,o.estadoCreditos$)),i(4),n("columns",o.columns)("displayedColumns",o.columns)("columnPropertyMap",o.columnPropertyMap)("data",o.data)("buttons",o.buttons)("searchTerm",o.searchTerm))},dependencies:[E,S,P,x,B,R,K,G,$,k,J,U,H]});let s=r;return s})();var Y=(()=>{let r=class r{constructor(){this.router=a(y),this.activatedRoute=a(A),this.cobroTrabadorService=a(M),this.idCredito="",this.datePipe=a(f),this.currencyPipe=a(u),this.columns=["Fecha de cobro","Nombre completo","Empresa","Concepto","Valor pendiente","Valor cuota","No. cuota","Estado"],this.columnPropertyMap={"Fecha de cobro":"fechaCobro","Nombre completo":"nombreTrabajador",Empresa:"nombreSubEmpresa",Concepto:"tipoConsumo","Valor pendiente":"valorPendiente","Valor cuota":"montoCuota","No. cuota":"numCuota",Estado:"nombreEstadoCredito"}}ngOnDestroy(){}ngOnInit(){this.idCredito=this.activatedRoute.snapshot.paramMap.get("id"),this.getDetalle(this.idCredito)}getDetalle(t){this.subcription$=this.cobroTrabadorService.getCobroEmpleado(t).pipe(d(e=>(e.data.forEach(o=>{o.fechaCobro=this.datePipe.transform(o.fechaCobro,"dd/MM/yyyy"),o.valorPendiente=this.currencyPipe.transform(o.valorPendiente,"USD","symbol","1.2-2"),o.montoCuota=this.currencyPipe.transform(o.montoCuota,"USD","symbol","1.2-2")}),e))).subscribe(e=>{console.log(e),this.detalle=e.data})}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=v({type:r,selectors:[["app-form-cobros-empleados"]],standalone:!0,features:[g([f,u]),C],decls:11,vars:8,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","justify-end","gap-2.5","sm:ml-4","sm:mt-0","sm:flex-row","sm:w-1/2"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-1/2",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data"]],template:function(e,o){e&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),c(3,"Historico de Cartera - Trabajadores"),l(),m(4,"div",3)(5,"mat-form-field",4),p(6,"mat-icon",5)(7,"input",6),l()()(),m(8,"div",7)(9,"div",8),p(10,"app-custom-table",9),l()()()),e&2&&(i(5),n("subscriptSizing","dynamic"),i(),n("svgIcon","heroicons_solid:magnifying-glass"),i(),n("autocomplete","off")("placeholder","Buscar"),i(3),n("columns",o.columns)("displayedColumns",o.columns)("columnPropertyMap",o.columnPropertyMap)("data",o.detalle))},dependencies:[P,E,S,x]});let s=r;return s})();var Re=[{path:"",component:X},{path:"cobro/:id",component:Y}];export{Re as default};
