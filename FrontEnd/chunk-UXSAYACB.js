import{a as j,b as ne}from"./chunk-7PXE4S5L.js";import{a as ot}from"./chunk-UOWP4OY2.js";import{a as Ye}from"./chunk-SMNJTA2L.js";import{a as et,b as tt,c as at}from"./chunk-WJEX57WX.js";import{a as Xe}from"./chunk-K2JQ4OKV.js";import{a as Ze,b as Ke,c as Qe}from"./chunk-CB4RFODM.js";import{a as L}from"./chunk-KDRCW2VF.js";import{a as B,b as he}from"./chunk-D35OUFHA.js";import{a as R}from"./chunk-HN2IWLXW.js";import{a as xe}from"./chunk-6B6PMKOT.js";import{a as Je}from"./chunk-CIRWMTLN.js";import{a as Ue,c as We}from"./chunk-ZSAEFQSV.js";import{a as re}from"./chunk-LUXURQN6.js";import{g as ge,j as He}from"./chunk-UD2FEJ4L.js";import{a as pe,b as ue,c as Re,d as fe}from"./chunk-MDZA5IL6.js";import"./chunk-XP7WEH62.js";import{C as oe,E as be,F as ie,J as O,b as Z,c as Be,e as Le,i as V,l as Q,n as F,p as X,q as Y,s as qe,u as ee,w as ze,x as te,y as ae}from"./chunk-KKJSUWDN.js";import{e as $e}from"./chunk-234L6G73.js";import{b as Ge,d as J}from"./chunk-UEKZXHJT.js";import{h as ce}from"./chunk-L5AVPIHT.js";import"./chunk-6KZCN3UQ.js";import{a as ve}from"./chunk-BP4Z4LAT.js";import"./chunk-LYM3MK3M.js";import{Ba as K,Q as k,R as N,ba as Oe,wa as G}from"./chunk-H26SRIJU.js";import{Ac as W,Cb as h,Dc as Ve,Eb as v,Ec as C,Gc as H,Hc as x,Lb as z,Mb as r,Nb as T,Ob as S,Pb as je,Qa as l,Sb as Ie,Tb as Ae,Ub as Me,Vb as P,W as Fe,Wb as D,Zb as ke,_ as le,cc as y,dc as U,ec as M,fc as Ee,gb as g,ha as c,ib as d,ma as w,pb as $,q as _e,tb as a,ub as t,vb as p,wa as _,wb as I,xa as E,xb as A,yc as Ne,zb as se,zc as de}from"./chunk-IEDNLM77.js";import{a as q,b as De,d as me}from"./chunk-NEB6MB4Y.js";var dt={validation:!1},rt=(()=>{let m=class m{constructor(){this.dialogRef=c(pe),this._matData=c(ue),this.fb=c(oe),this.pagoTrabajadoresService=c(j),this.estadosDatosService=c(R),this.swalService=c(re)}ngOnInit(){this.createForm();let e=this._matData.data;console.log(e),this.form.patchValue({valorRecibido:parseFloat(e.total.replace(/[\$,]/g,""))})}onCambioEstado(){if(this.form.valid){let o=this._matData.data,e=this.form.getRawValue(),{valorRecibido:u}=e,f=me(e,["valorRecibido"]),b=q({id:o.id,idEstadoCobroPago:ne.PAGADOS,valorRecibido:parseFloat(u)},f);this.pagoTrabajadoresService.putPagoTrabajadorIndividual(b).subscribe(Ce=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.closeDialog()},Ce=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})})}}closeDialog(){this.dialogRef.close()}createForm(){this.form=this.fb.group({comprobante:["",F.required],valorRecibido:[""],observacion:[""]})}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=w({type:m,selectors:[["app-dialog-estado"]],standalone:!0,features:[P([{provide:N,useClass:L},{provide:k,useValue:"en-GB"},C,x,B(dt)]),D],decls:30,vars:8,consts:[[1,"relative","flex","h-full","w-full","flex-col"],[1,"flex","flex-auto","flex-col","items-center","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex","h-10","w-10","flex-0","items-center","justify-center","rounded-full","sm:mr-4","bg-blue-100","text-blue-600","dark:bg-blue-600","dark:text-blue-50"],[3,"svgIcon"],[1,"flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:pr-8","sm:text-left"],[1,"text-xl","font-medium","leading-6"],[1,"text-secondary"],[1,"mt-8",3,"formGroup"],[1,"mt-4","flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:text-left"],["floatLabel","always",1,"w-full","min-w-90"],["matInput","","placeholder","Comprobante",3,"formControlName"],["matInput","","placeholder","Valor recibido","mask","separator.2","thousandSeparator",",","decimalMarker",".",3,"formControlName"],["floatLabel","always",1,"w-full"],["matInput","","placeholder","Observaciones",3,"formControlName"],[1,"flex","items-center","justify-center","space-x-3","bg-gray-50","py-4","dark:bg-black","dark:bg-opacity-10","sm:justify-end"],["mat-stroked-button","",1,"sm:w-auto","w-full","bg-crediorange-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"matDialogClose"],["mat-flat-button","",1,"sm:w-auto","w-full","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click","color","matDialogClose"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),p(3,"mat-icon",3),t(),a(4,"div",4)(5,"div",5),r(6," Confirmacion "),t(),a(7,"div",6),r(8," \xBFEst\xE1 seguro de cambiar el estado?. "),t()()(),a(9,"form",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label"),r(13,"N\xFAmero de comprobante"),t(),p(14,"input",10),t()(),a(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),r(18,"Valor recibido"),t(),p(19,"input",11),t()(),a(20,"div",8)(21,"mat-form-field",12)(22,"mat-label"),r(23,"Observaciones"),t(),p(24,"textarea",13),t()()(),a(25,"div",14)(26,"button",15),r(27," Cancelar "),t(),a(28,"button",16),h("click",function(){return n.onCambioEstado()}),r(29," Confirmar "),t()()()),o&2&&(l(3),d("svgIcon","heroicons_solid:question-mark-circle"),l(6),d("formGroup",n.form),l(5),d("formControlName","comprobante"),l(5),d("formControlName","valorRecibido"),l(5),d("formControlName","observacion"),l(2),d("matDialogClose","cancelled"),l(2),d("color","primary")("matDialogClose","confirmed"))},dependencies:[G,K,fe,V,O,Z,ie,ee,Q,X,Y,te,ae,be,he]});let i=m;return i})();function ct(i,m){i&1&&(a(0,"span"),r(1,"Error el abono no puede ser mayor igual al total, favor realice el pago por cambio de estado."),t())}function pt(i,m){if(i&1&&(a(0,"mat-error"),g(1,ct,2,0,"span",12),t()),i&2){let s,e=v();l(),d("ngIf",(s=e.form.get("valor").errors)==null?null:s.maxAmount)}}var ut={validation:!1},nt=(()=>{let m=class m{constructor(){this.dialogRef=c(pe),this._matData=c(ue),this.fb=c(oe),this.estadosDatosService=c(R),this.pagoTrabajadoresService=c(j),this.swalService=c(re)}ngOnInit(){this.createForm();let e=this._matData.data,o=typeof e.total=="string"?parseFloat(e.total.replace(/[\$,]/g,"")):typeof e.total=="number"?e.total:0,n=typeof e.totalAbono=="string"?parseFloat(e.totalAbono.replace(/[\$,]/g,"")):typeof e.totalAbono=="number"?e.totalAbono:0;this.form.get("valor").setValidators([ft(o,n),F.required]),this.form.updateValueAndValidity()}closeDialog(){this.dialogRef.close()}createForm(){this.form=this.fb.group({comprobante:["",F.required],valor:["",F.required],idPagoTrabajador:[""]})}onAbono(){if(this.form.valid){let e=this._matData.data,o=this.form.getRawValue(),{valor:n,comprobante:u}=o,f={idPagoTrabajador:e.id,valor:parseFloat(n),comprobante:u};this.pagoTrabajadoresService.pagoTrabajadoresAbono(f).subscribe(b=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.closeDialog()},b=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})})}}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=w({type:m,selectors:[["app-dialog-abono-individual"]],standalone:!0,features:[P([{provide:N,useClass:L},{provide:k,useValue:"en-GB"},C,x,B(ut)]),D],decls:26,vars:9,consts:[[1,"relative","flex","h-full","w-full","flex-col"],[1,"flex","flex-auto","flex-col","items-center","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex","h-10","w-10","flex-0","items-center","justify-center","rounded-full","sm:mr-4","bg-blue-100","text-blue-600","dark:bg-blue-600","dark:text-blue-50"],[3,"svgIcon"],[1,"flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:pr-8","sm:text-left"],[1,"text-xl","font-medium","leading-6"],[1,"text-secondary"],[1,"mt-8",3,"formGroup"],[1,"mt-4","flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:text-left"],["floatLabel","always",1,"w-full","min-w-90"],["matInput","","placeholder","Comprobante",3,"formControlName"],["matInput","","placeholder","Valor recibido","mask","separator.2","thousandSeparator",",","decimalMarker",".",3,"formControlName"],[4,"ngIf"],[1,"flex","items-center","justify-center","space-x-3","bg-gray-50","py-4","dark:bg-black","dark:bg-opacity-10","sm:justify-end"],["mat-stroked-button","",1,"sm:w-auto","w-full","bg-crediorange-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"matDialogClose"],["mat-flat-button","",1,"sm:w-auto","w-full","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click","color","matDialogClose","disabled"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),p(3,"mat-icon",3),t(),a(4,"div",4)(5,"div",5),r(6," Confirmacion "),t(),a(7,"div",6),r(8," \xBFEst\xE1 seguro de realizar abono?. "),t()()(),a(9,"form",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label"),r(13,"N\xFAmero de comprobante"),t(),p(14,"input",10),t()(),a(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),r(18,"Valor abono"),t(),p(19,"input",11),g(20,pt,2,1,"mat-error",12),t()()(),a(21,"div",13)(22,"button",14),r(23," Cancelar "),t(),a(24,"button",15),h("click",function(){return n.onAbono()}),r(25," Guardar "),t()()()),o&2&&(l(3),d("svgIcon","heroicons_solid:question-mark-circle"),l(6),d("formGroup",n.form),l(5),d("formControlName","comprobante"),l(5),d("formControlName","valor"),l(),d("ngIf",n.form.get("valor").dirty||n.form.get("valor").touched),l(2),d("matDialogClose","cancelled"),l(2),d("color","primary")("matDialogClose","confirmed")("disabled",n.form.invalid))},dependencies:[be,ee,Q,X,Y,G,Be,V,K,O,Z,W,he,fe,ie,te,ae]});let i=m;return i})();function ft(i,m){return s=>{let e=s.value,o=i-m;return e>=o?{maxAmount:{maxValue:o,actual:e}}:null}}function gt(i,m){if(i&1&&(I(0),p(1,"app-custom-table",19),A()),i&2){let s=v(2);l(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)("searchTerm",s.searchTerm)}}function bt(i,m){i&1&&(a(0,"div",20)(1,"div",21)(2,"fuse-alert",22)(3,"span",23),r(4,"Informaci\xF3n"),t(),r(5," No hay pagos pendientes hasta el momento. "),t()()()),i&2&&(l(2),d("type","info")("appearance","outline"))}function vt(i,m){if(i&1&&g(0,gt,2,6,"ng-container",18)(1,bt,6,2,"ng-template",null,1,Ee),i&2){let s=z(2),e=v();d("ngIf",e.data.length)("ngIfElse",s)}}function xt(i,m){if(i&1&&(I(0),p(1,"app-custom-table",19),A()),i&2){let s=v(2);l(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttonsPagados)("searchTerm",s.searchTerm)}}function ht(i,m){i&1&&(a(0,"div",20)(1,"div",21)(2,"fuse-alert",22)(3,"span",23),r(4,"Informaci\xF3n"),t(),r(5," No hay pagos hasta el momento. "),t()()()),i&2&&(l(2),d("type","info")("appearance","outline"))}function yt(i,m){if(i&1&&g(0,xt,2,6,"ng-container",18)(1,ht,6,2,"ng-template",null,1,Ee),i&2){let s=z(2),e=v();d("ngIf",e.data.length)("ngIfElse",s)}}var lt=(()=>{let m=class m{constructor(){this.datePipe=c(C),this.searchTerm="",this.currencyPipe=c(x),this.pagoTrabajadorService=c(j),this._matDialog=c(Re),this.estadoDatosService=c(R),this.router=c(J),this.selectedTab=ne.PENDIENTES,this.data=[],this.columns=["N\xFAmero de pago","Identificaci\xF3n","Nombres Apellidos","Empresa","Total","Estado"],this.columnPropertyMap={"N\xFAmero de pago":"consecutivo",Identificaci\u00F3n:"numDocumento","Nombres Apellidos":"nombreTrabajador",Empresa:"nombreSubempresa",Total:"total",Estado:"nombreEstadoCobro"},this.buttons=[{label:"Ver",icon:"visibility",action:e=>{console.log("Editing",e),this.router.navigate(["/pages/gestion-cobros/trabajador/individual/",e.id])}},{label:"Cambiar estado",icon:"published_with_changes",action:e=>{console.log("View",e),this.selectedData=e,this.onCambioEstado()}},{label:"Abonos",icon:"request_quote",action:e=>{console.log("View",e),this.selectedData=e,this.onAbono()}}],this.buttonsPagados=[{label:"Ver",icon:"visibility",action:e=>{console.log("Editing",e),this.router.navigate(["/pages/gestion-cobros/trabajador/individual/",e.id])}}],this.tabChanged=e=>{this.tabIndex=e.index,this.selectedTab=e.index==0?ne.PENDIENTES:ne.PAGADOS,this.getPagoTrabajadores(this.selectedTab)}}onCambioEstado(){this._matDialog.open(rt,{autoFocus:!1,data:{edit:!0,data:this.selectedData},width:"30%",disableClose:!0,panelClass:"custom-dialog-container"})}onAbono(){this._matDialog.open(nt,{autoFocus:!1,data:{edit:!0,data:this.selectedData},width:"30%",disableClose:!0,panelClass:"custom-dialog-container"})}ngOnDestroy(){}ngOnInit(){this.getPagoTrabajadores(this.selectedTab),this.listenGrid()}onNew(){this.router.navigate(["/pages/gestion-cobros/trabajador/individual"])}getPagoTrabajadores(e){this.pagoTrabajadorService.getPagoTrabajadorIndividual(e).pipe(le(o=>(o.data.forEach(n=>{n.fechaCreacion=this.datePipe.transform(n.fechaCreacion,"dd/MM/yyyy"),n.total=this.currencyPipe.transform(n.total,"USD","symbol","1.2-2")}),o))).subscribe(o=>{o.data&&(this.data=o.data)})}onSearch(e){let o=e.target;this.searchTerm=o.value.trim().toLowerCase()}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(o=>{o&&this.getPagoTrabajadores(this.selectedTab)})}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=w({type:m,selectors:[["app-grid-pago-trabajador"]],standalone:!0,features:[P([C,x]),D],decls:20,vars:8,consts:[["tabGroup",""],["noData",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],["mat-stretch-tabs","false",1,"sm:px-2",3,"selectedIndexChange","selectedTabChange","animationDuration","selectedIndex"],["label","Pendientes"],["matTabContent",""],["label","Pagados"],[4,"ngIf","ngIfElse"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons","searchTerm"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-2","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(o,n){if(o&1){let u=se();a(0,"div",2)(1,"div",3)(2,"div",4),r(3,"Registro de Cobro Individual"),t(),a(4,"div",5)(5,"mat-form-field",6),p(6,"mat-icon",7),a(7,"input",8),h("input",function(b){return _(u),E(n.onSearch(b))}),t()(),a(8,"button",9),h("click",function(){return _(u),E(n.onNew())}),p(9,"mat-icon",10),a(10,"span",11),r(11,"Registrar"),t()()()(),a(12,"div",12)(13,"div",13)(14,"mat-tab-group",14,0),Me("selectedIndexChange",function(b){return _(u),Ae(n.tabIndex,b)||(n.tabIndex=b),E(b)}),h("selectedTabChange",function(b){return _(u),E(n.tabChanged(b))}),a(16,"mat-tab",15),g(17,vt,3,2,"ng-template",16),t(),a(18,"mat-tab",17),g(19,yt,3,2,"ng-template",16),t()()()()()}o&2&&(l(5),d("subscriptSizing","dynamic"),l(),d("svgIcon","heroicons_solid:magnifying-glass"),l(),d("autocomplete","off")("placeholder","Buscar"),l(),d("color","primary"),l(),d("svgIcon","heroicons_outline:plus"),l(5),d("animationDuration","500"),Ie("selectedIndex",n.tabIndex))},dependencies:[xe,G,V,K,O,ve,tt,et,at,W]});let i=m;return i})();var Ct=(i,m)=>({"bg-credigray-100":i,"bg-green-600":m});function St(i,m){if(i&1&&(a(0,"mat-option",27),r(1),t()),i&2){let s=m.$implicit;d("value",s.id),l(),T(s.razonSocial)}}function _t(i,m){if(i&1&&(I(0),g(1,St,2,2,"mat-option",15),A()),i&2){let s=m.ngIf;l(),d("ngForOf",s.data)}}function Et(i,m){if(i&1&&(a(0,"mat-option",27),r(1),t()),i&2){let s=m.$implicit;d("value",s),l(),je(" ",s.primerNombre," ",s.primerApellido," ")}}function Tt(i,m){i&1&&(a(0,"div",28)(1,"mat-form-field",29)(2,"mat-label"),r(3,"Observaciones"),t(),p(4,"textarea",30),t()()),i&2&&(l(4),d("formControlName","observacion"))}function wt(i,m){if(i&1&&(a(0,"div",23)(1,"div",31)(2,"p",32),r(3,"Movimientos"),t(),p(4,"app-custom-table",33),t()()),i&2){let s=v();l(4),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)}}function Pt(i,m){if(i&1&&(a(0,"div",24)(1,"div",34)(2,"fuse-alert",35)(3,"span",36),r(4,"Informaci\xF3n"),t(),r(5),t()()()),i&2){let s=v();l(2),d("type","info")("appearance","outline"),l(3),S(" ",s.message," ")}}function Dt(i,m){if(i&1&&(a(0,"span",26),r(1,"Subtotal: "),a(2,"span",37),r(3),y(4,"currency"),t()()),i&2){let s=v();l(3),T(U(4,1,s.subtotal))}}function Ft(i,m){if(i&1&&(a(0,"span",26),r(1,"Comisiones: "),a(2,"span",37),r(3),y(4,"currency"),t()()),i&2){let s=v();l(3),T(U(4,1,s.totalComision))}}function jt(i,m){if(i&1&&(a(0,"span",26),r(1,"Total a pagar: "),a(2,"span",37),r(3),y(4,"currency"),t()()),i&2){let s=v();l(3),S(" ",U(4,1,s.totalPagar)," ")}}var It={validation:!1},mt=(()=>{let m=class m{constructor(){this.fb=c(oe),this.empresaClienteService=c(Xe),this.pagoTrabajadorService=c(j),this.cobroTrabajadorService=c(ot),this.datePipe=c(C),this.swalService=c(re),this.estadosDatosService=c(R),this.fuseService=c(ge),this.currencyPipe=c(x),this.decimalPipe=c(H),this.router=c(J),this.empleadosService=c(Ye),this.empleadoControl=new qe(""),this.aesEncriptService=c($e),this.empresa$=this.empresaClienteService.getEmpresasClientes().pipe(le(e=>{let o=e.data;o&&(this.form.get("idSubEmpresa").setValue(o[0].id),this.getEmpleadosSubEmpresas(o[0].id))})),this.tipoPago$=this.pagoTrabajadorService.tipoPagoTrabajadores().pipe(le(e=>{let o=e.data;o&&(this.selectOptionValue=o)})),this.empleados=[],this.data=[],this.columns=["Empresa","N factura / Comprobante","Valor pendiente"],this.columnPropertyMap={Empresa:"nombreSubEmpresa","N factura / Comprobante":"numeroFactura","Valor pendiente":"valorPendiente"}}displayFn(e){return e?`${e.primerNombre} ${e.primerApellido}`:""}_filter(e){let o=e.toLowerCase();return this.empleados.filter(n=>`${n.primerNombre} ${n.primerApellido}`.toLowerCase().includes(o))}onOptionSelected(e){let o=e.option.value;this.empleadoControl.setValue(o),this.form.get("idTrabajador").setValue(o.id)}createForm(){this.form=this.fb.group({fechaFinal:["",F.required],idSubEmpresa:["",F.required],idTrabajador:["",F.required],observacion:[""]})}ngOnInit(){this.createForm(),this.filteredEmpleados$=this.empleadoControl.valueChanges.pipe(Fe(""),_e(e=>{let o=typeof e=="string"?e:e?.primerNombre||e?.primerApellido;return o?this._filter(o):this.empleados.slice()}))}actualizaSelected(e){e===this.totalPagar?(console.log("Si entra al actualizar"),this.form.get("idTipoPagoTrabajador").setValue(this.selectOptionValue[0].id)):e<this.totalPagar&&(console.log("Si entra al actualizar 2"),this.form.get("idTipoPagoTrabajador").setValue(this.selectOptionValue[1].id))}get valorAbono(){return this.form.get("valorAbono")}maxAmountValidator(e){if(e.value===null||e.value===void 0||e.value==="")return null;console.log(e.value);let o=parseFloat(e.value.toString().replace(/,/g,""));return console.log(o),o===0?{valueZero:!0}:o>this.totalPagar?(console.log("Si entra"),{exceedsBalance:!0}):null}closeDialog(){this.router.navigate(["/pages/gestion-cobros/trabajador"])}getEmpleadosSubEmpresas(e){this.empleadosService.getEmpleadosSubempresas(e).subscribe(o=>{o.data&&(this.empleados=o.data)})}selectedEmpleados(e){let o=e.value;this.empleadosService.getEmpleadosSubempresas(o).subscribe(n=>{n.data&&(this.empleados=n.data,this.empleadoControl.reset(""))})}onGet(){if(this.form.valid){let{fechaFinal:e,idSubEmpresa:o,idTrabajador:n}=this.form.getRawValue(),f={fechaFinallData:this.datePipe.transform(e,"yyyy-MM-dd"),idSubEmpresa:o,idTrabajador:n};console.log(f),this.getAllPagoTrabajador(f)}}onSave(){let Pe=this.form.getRawValue(),{fechaFinal:e,idSubEmpresa:o,idTrabajador:n,idTipoPagoTrabajador:u}=Pe,f=me(Pe,["fechaFinal","idSubEmpresa","idTrabajador","idTipoPagoTrabajador"]),Ce={fechaFinal:this.datePipe.transform(e,"yyyy-MM-dd"),idSubEmpresa:o},Te=[];Te=this.data.map(Se=>({idCobroTrabajador:Se.id}));let we=q(De(q({},Ce),{detallePagoTrabajador:Te,idTrabajador:n}),f);console.log(we),this.fuseService.open(q({},He)).afterClosed().subscribe(Se=>{Se==="confirmed"&&this.postSave(we)})}getAllPagoTrabajador(e){this.cobroTrabajadorService.getCobroTrabajador(e).pipe(_e(o=>(this.subtotal=0,this.totalComision=0,this.totalPagar=0,o&&Array.isArray(o.data)?o.data.forEach(n=>{n.montoCuota&&(n.montoCuota=this.aesEncriptService.decrypt(n.montoCuota)),n.valorPendiente&&(n.valorPendiente=this.aesEncriptService.decrypt(n.valorPendiente)),n.montoCuota=this.currencyPipe.transform(n.montoCuota,"USD","symbol","1.2-2"),n.comision=this.currencyPipe.transform(n.comision,"USD","symbol","1.2-2"),n.pagar=this.currencyPipe.transform(n.pagar,"USD","symbol","1.2-2"),n.valorPendiente=this.currencyPipe.transform(n.valorPendiente,"USD","symbol","1.2-2"),n.fechaCobro=this.datePipe.transform(n.fechaCobro,"dd/MM/yyyy"),this.totalPagar+=parseFloat(n.valorPendiente.replace(/[^0-9.-]+/g,""))}):this.data=[],o))).subscribe(o=>{o&&Array.isArray(o.data)?this.data=o.data:(this.data=[],this.message=o.msg)})}postSave(e){this.pagoTrabajadorService.postPagoTrabajador(e).subscribe(o=>{this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.estadosDatosService.stateGrid.next(!0),this.closeDialog()},o=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})})}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=w({type:m,selectors:[["app-form-pago-trabajador"]],standalone:!0,features:[P([{provide:N,useClass:L},{provide:k,useValue:"en-GB"},C,x,H,B(It)]),D],decls:49,vars:26,consts:[["finalPicker",""],["auto","matAutocomplete"],["cdkScrollable","",1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:inset-0","sm:overflow-hidden"],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","pl-8"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","sm:flex-row","md:px-8"],[1,"mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","gap-2.5"],["floatLabel","always",1,"w-full","min-w-90"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["placeholder","Empresa",3,"selectionChange","formControlName"],[4,"ngIf"],["type","text","placeholder","Trabajadores","matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["class","flex flex-col items-baseline sm:flex-row gap-2.5",4,"ngIf"],[1,"relative","border","border-gray-300","rounded-lg"],[1,"absolute","-top-3","left-4","bg-white","px-2","text-gray-500","font-semibold"],[1,"flex","flex-wrap","justify-end","gap-2.5","sm:mb-4","pr-2"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"lg:w-auto","w-full","sm:mt-6","transition","duration-200","text-white","font-semibold","rounded-lg","md:w-auto",3,"click","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","gap-4","justify-end","sm:flex-row"],[1,"sm:pr-4","text-gray-600","font-bold","text-right"],[3,"value"],[1,"flex","flex-col","items-baseline","sm:flex-row","gap-2.5"],["floatLabel","always",1,"w-full"],["matInput","","placeholder","Observaciones",3,"formControlName"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:p-4","sm:mb-10","sm:overflow-y-auto"],[1,"text-lg","text-black","font-semibold","mb-4"],[3,"columns","displayedColumns","columnPropertyMap","data"],[1,"inline-block","p-4","sm:p-8","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""],[1,"text-gray-800"]],template:function(o,n){if(o&1){let u=se();a(0,"div",2)(1,"div",3),r(2," Cobro Individual "),t(),a(3,"div",4)(4,"div",5)(5,"form",6)(6,"div",7)(7,"mat-form-field",8)(8,"mat-label"),r(9,"Fecha de corte"),t(),p(10,"input",9)(11,"mat-datepicker-toggle",10)(12,"mat-datepicker",null,0),t(),a(14,"mat-form-field",8)(15,"mat-label"),r(16,"Empresa"),t(),a(17,"mat-select",11),h("selectionChange",function(b){return _(u),E(n.selectedEmpleados(b))}),g(18,_t,2,1,"ng-container",12),y(19,"async"),t()()(),a(20,"div",7)(21,"mat-form-field",8)(22,"mat-label"),r(23,"Trabajadores"),t(),p(24,"input",13),a(25,"mat-autocomplete",14,1),h("optionSelected",function(b){return _(u),E(n.onOptionSelected(b))}),g(27,Et,2,3,"mat-option",15),y(28,"async"),t()()(),g(29,Tt,5,1,"div",16),a(30,"div",17)(31,"div",18),r(32," Opciones "),t(),a(33,"div",19)(34,"button",20),h("click",function(){return _(u),E(n.closeDialog())}),a(35,"span"),r(36," Atras "),t()(),a(37,"button",21),h("click",function(){return _(u),E(n.onGet())}),a(38,"span"),r(39," Consultar "),t()(),a(40,"button",22),h("click",function(){return _(u),E(n.onSave())}),a(41,"span"),r(42," Registrar "),t()()()()()()(),g(43,wt,5,4,"div",23)(44,Pt,6,3,"div",24),a(45,"div",25),g(46,Dt,5,3,"span",26)(47,Ft,5,3,"span",26)(48,jt,5,3,"span",26),t()()}if(o&2){let u=z(13),f=z(26);l(5),d("formGroup",n.form),l(5),d("matDatepicker",u)("formControlName","fechaFinal"),l(),d("for",u),l(6),d("formControlName","idSubEmpresa"),l(),d("ngIf",U(19,19,n.empresa$)),l(6),d("formControl",n.empleadoControl)("matAutocomplete",f),l(),d("displayWith",n.displayFn),l(2),d("ngForOf",U(28,21,n.filteredEmpleados$)),l(2),d("ngIf",n.data.length),l(5),d("color","primary"),l(3),d("color","primary"),l(3),d("ngClass",ke(23,Ct,n.data.length==0,n.data.length>0))("disabled",n.data.length==0||n.form.invalid),l(3),$(n.data.length?43:n.message?44:-1),l(3),$(n.subtotal?46:-1),l(),$(n.totalComision?47:-1),l(),$(n.totalPagar?48:-1)}},dependencies:[Ve,x,xe,ve,G,Ze,Ke,Qe,V,O,Z,Oe,Je,Le,de,W,ie,ee,Q,X,Y,ze,te,ae,Ne,ce,Ue,We]});let i=m;return i})();function At(i,m){if(i&1&&(I(0),a(1,"div",30),r(2),t(),a(3,"div",30),r(4),t(),a(5,"div",31),r(6),y(7,"currency"),t(),p(8,"div",21),A()),i&2){let s=m.$implicit;l(2),S(" ",s.nombreCompleto," "),l(2),S(" ",s.numeroFactura," "),l(2),S(" ",M(7,3,s.valorPago,"USD")," ")}}function Mt(i,m){if(i&1&&(I(0),a(1,"div",30),r(2),y(3,"date"),t(),a(4,"div",32),r(5),t(),a(6,"div",33),r(7),y(8,"currency"),t(),p(9,"div",21),A()),i&2){let s=m.$implicit;l(2),S(" ",M(3,3,s.fechaCreacion,"dd/MM/yyyy")," "),l(3),S(" ",s.comprobante," "),l(2),S(" ",M(8,6,s.valor,"USD")," ")}}function kt(i,m){if(i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),r(6," N\xFAmero de pago "),t(),a(7,"div",6),r(8),t(),a(9,"div",7)(10,"div",8),r(11),t()(),p(12,"div",9),a(13,"div",10),r(14," Periodo inicial "),t(),a(15,"div",11),r(16),y(17,"date"),t(),a(18,"div",10),r(19," Periodo final "),t(),a(20,"div",11),r(21),y(22,"date"),t(),a(23,"div",10),r(24," Total "),t(),a(25,"div",11),r(26),y(27,"currency"),t(),a(28,"div",10),r(29," Estado "),t(),a(30,"div",11),r(31),t()(),a(32,"div",12)(33,"div",13),p(34,"img",14),t(),a(35,"div",15)(36,"div"),r(37,"Calle 70B Cra 41 # 187"),t(),a(38,"div"),r(39,"Barranquilla - Atlantico"),t(),a(40,"div"),r(41,"+57 301 2523319"),t(),a(42,"div"),r(43,"info@crediplus.com.co"),t(),a(44,"a",16),r(45,"crediplus.com.co"),t()()()(),a(46,"div",17)(47,"div",18),r(48," Detalles de Pago "),t(),a(49,"div",19),r(50," Nombre completo "),t(),a(51,"div",19),r(52," Factura No "),t(),a(53,"div",20),r(54," Valor "),t(),p(55,"div",21),g(56,At,9,6,"ng-container",22),a(57,"div",23),r(58," Abonos Realizados "),t(),a(59,"div",19),r(60," Fecha de abono "),t(),a(61,"div",19),r(62," Factura No "),t(),a(63,"div",20),r(64," Valor abonado "),t(),p(65,"div",21),g(66,Mt,10,9,"ng-container",22),p(67,"div",24),a(68,"div",25),r(69," Observaciones "),t(),a(70,"div",26),r(71),t(),p(72,"div",27),a(73,"div",28),r(74," Total a cobrar "),t(),a(75,"div",29),r(76),y(77,"currency"),t()()()()()),i&2){let s=v();l(8),T(s.detalleFactura.consecutivo),l(3),S("Trabajador: ",s.detalleFactura.nombreTrabajador,""),l(5),T(M(17,10,s.detalleFactura.fechaIncial,"dd/MM/yyyy")),l(5),T(M(22,13,s.detalleFactura.fechaFinal,"dd/MM/yyyy")),l(5),T(M(27,16,s.detalleFactura.total,"USD")),l(5),T(s.detalleFactura.nombreEstadoCobro),l(25),d("ngForOf",s.detalleFactura.detallePagoTrabajador),l(10),d("ngForOf",s.detalleFactura.abonosPagos),l(5),T(s.detalleFactura.observacion),l(5),S(" ",M(77,19,s.detalleFactura.total,"USD")," ")}}var Nt={validation:!1},st=(()=>{let m=class m{constructor(){this.fuseService=c(ge),this.currencyPipe=c(x),this.decimalPipe=c(H),this.router=c(J),this.activatedRoute=c(Ge),this.datePipe=c(C),this.pagoTrabajadorService=c(j)}ngOnDestroy(){}ngOnInit(){let e=this.activatedRoute.snapshot.paramMap.get("id");this.getPagoIndividual(e)}getPagoIndividual(e){this.subcription$=this.pagoTrabajadorService.getPagosTrabajadorIndividual(e).subscribe(o=>{o.data&&(this.detalleFactura=o.data)})}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=w({type:m,selectors:[["app-form-view-pago-trabajador"]],standalone:!0,features:[P([{provide:N,useClass:L},{provide:k,useValue:"en-GB"},C,x,H,B(Nt)]),D],decls:1,vars:1,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","text-center","print:overflow-visible"],[1,"inline-block","p-6","text-left","sm:p-10","print:p-0"],[1,"bg-card","w-240","rounded-2xl","p-16","shadow","print:w-auto","print:rounded-none","print:bg-transparent","print:shadow-none"],[1,"flex","items-start","justify-between"],[1,"grid","grid-cols-2","gap-x-4","gap-y-1"],[1,"text-secondary","text-2xl","tracking-tight"],[1,"text-2xl"],[1,"text-md","mt-6"],[1,"text-xl","font-medium"],[1,"text-secondary","font-medium","tracking-tight","col-span-2"],[1,"text-secondary","font-medium","tracking-tight"],[1,"font-medium"],[1,"dark","-mr-16","grid","auto-cols-max","grid-flow-col","gap-x-8","rounded-l-2xl","bg-accent","px-8","py-6"],[1,"w-24","place-self-center"],["src","images/logo/logo-blanco.svg",1,"w-24"],[1,"border-l","pl-10","text-md"],["target","_blank","href","https://crediplus.com.co"],[1,"mt-12","grid","grid-cols-12","gap-x-1"],[1,"col-span-12","text-xl","font-bold","mb-4"],[1,"text-secondary","col-span-4","text-lg","font-medium"],[1,"text-secondary","col-span-4","text-right","text-lg","font-medium"],[1,"col-span-12","my-4","border-b"],[4,"ngFor","ngForOf"],[1,"col-span-12","text-xl","font-bold","mt-8","mb-4"],[1,"col-span-12","mt-16"],[1,"text-secondary","col-span-2","self-center","font-medium","tracking-tight"],[1,"col-span-10","text-right","text-lg"],[1,"col-span-12","my-3","border-b"],[1,"text-secondary","col-span-10","self-center","text-2xl","font-medium","tracking-tight"],[1,"col-span-2","text-right","text-2xl","font-medium"],[1,"col-span-4","text-md","tracking-tight"],[1,"col-span-4","self-center","text-right"],[1,"col-span-4","self-center","tracking-tight"],[1,"col-span-4","text-md","text-right"]],template:function(o,n){o&1&&g(0,kt,78,22,"div",0),o&2&&$(n.detalleFactura?0:-1)},dependencies:[ce,x,C,de]});let i=m;return i})();var Fo=[{path:"",component:lt},{path:"individual",component:mt},{path:"individual/:id",component:st}];export{Fo as default};
